{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Dashboard{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bg-custom {
            background-image: linear-gradient(rgba(128, 128, 128, 0.7), rgba(128, 128, 128, 0.625)), url("{% static 'images/background.jpg' %}");
            background-attachment: fixed;
        }
        .sidebar-transition {
            transition: transform 0.3s ease-in-out;
        }
        .rotate-180 {
            transform: rotate(180deg);
        }
        .dropdown-content {
            transition: max-height 0.3s ease-out, opacity 0.2s ease;
        }
        .group-hover\:scale-y-100 {
            transform: scaleY(1);
        }
        .group-hover .fa-chevron-down {
            transform: rotate(180deg);
            transition: transform 0.3s ease;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Rouge+Script&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
    {% block extra_css %}{% endblock %}
</head>
<body class="bg-custom min-h-screen">
    <!-- Mobile Sidebar -->
    <div id="mobile-sidebar" class="fixed lg:hidden top-0 left-0 h-full w-64 bg-[#EAEAEA] shadow-lg sidebar-transition transform -translate-x-full z-50 overflow-y-auto">
        <div class="p-4 space-y-2 mt-16">
            <a href="{% url 'saritasapp:made_to_order' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <span class="font-semibold">Made to Order</span>
            </a>
            
            <!-- Mobile Packages Dropdown -->
            <div class="dropdown relative">
                <button class="w-full px-4 py-2 text-left text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors flex justify-between items-center">
                    <span>Packages</span>
                    <i class="fas fa-chevron-down transition-transform"></i>
                </button>
                <div class="dropdown-content pl-4 max-h-0 overflow-hidden transition-all duration-300">
                    <a href="{% url 'saritasapp:wardrobe_package_list' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Wardrobe Packages
                    </a>
                    <a href="{% url 'saritasapp:wedding_packages' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Wedding Packages
                    </a>
                    <a href="{% url 'saritasapp:debut_packages' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Debut Packages
                    </a>
                    <a href="{% url 'saritasapp:additional_services' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Additional Services
                    </a>
                </div>
            </div>

            <!-- Navigation Items -->
            <a href="{% url 'saritasapp:inventory_list' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-box w-6 text-center mr-2"></i>
                <span>Inventory</span>
            </a>
            <a href="{% url 'saritasapp:calendar' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-calendar w-6 text-center mr-2"></i>
                <span>Calendar of Event</span>
            </a>
            <a href="{% url 'saritasapp:rental_tracker' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-chart-line w-6 text-center mr-2"></i>
                <span>Rental Tracker</span>
            </a>
            
            <!-- Staff-only Approvals Dropdown (Mobile) -->
            {% if user.is_staff %}
            <div class="dropdown relative">
                <button class="w-full px-4 py-2 text-left text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors flex justify-between items-center">
                    <i class="fas fa-clipboard-check w-6 text-center mr-2"></i>
                    <span>Approvals</span>
                    <i class="fas fa-chevron-down transition-transform"></i>
                </button>
                <div class="dropdown-content pl-4 max-h-0 overflow-hidden transition-all duration-300">
                    <a href="{% url 'saritasapp:rental_approvals' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Item Rentals
                    </a>
                    <a href="{% url 'saritasapp:package_rental_approvals' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Package Rentals
                    </a>
                </div>
            </div>
            {% else %}
            <a href="{% url 'saritasapp:rental_approvals' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-clipboard-check w-6 text-center mr-2"></i>
                <span>Rental Approvals</span>
            </a>
            {% endif %}
            
            <a href="{% url 'saritasapp:view_reservations' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-calendar-check w-6 text-center mr-2"></i>
                <span>View Reservations</span>
            </a>
            <a href="{% url 'saritasapp:receipt-detail' receipt_id=1 %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-receipt w-6 text-center mr-2"></i>
                <span>Receipt</span>
            </a>
            <a href="{% url 'saritasapp:data_analysis' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-chart-bar w-6 text-center mr-2"></i>
                <span>Data Analysis</span>
            </a>
            <a href="{% url 'saritasapp:customer_list' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-users w-6 text-center mr-2"></i>
                <span>Customer Records</span>
            </a>
            <a href="{% url 'saritasapp:manage_staff' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-user-shield w-6 text-center mr-2"></i>
                <span>Manage Staff</span>
            </a>

            <!-- Auth Section -->
            <div class="mt-4 border-t pt-4">
                <a href="{% url 'saritasapp:staff_profile' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                    <i class="fas fa-user w-6 text-center mr-2"></i>
                    <span>Profile</span>
                </a>
                {% if user.is_authenticated %}
                <form method="post" action="{% url 'saritasapp:logout' %}" class="w-full">
                    {% csrf_token %}
                    <button type="submit" class="w-full px-4 py-2 text-left text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Logout
                    </button>
                </form>
                {% else %}
                <a href="{% url 'saritasapp:sign_in' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                    Login
                </a>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Desktop Sidebar -->
    <div class="hidden lg:block fixed top-0 left-0 h-full w-60 bg-[#EAEAEA] shadow-lg z-40 overflow-y-auto">
        <div class="p-4 space-y-2 mt-16">
            <a href="{% url 'saritasapp:made_to_order' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-cut w-6 text-center mr-2"></i>
                <span>Made to Order</span>
            </a>
            
            <!-- Desktop Packages Dropdown -->
            <div class="dropdown relative">
                <button class="w-full px-4 py-2 text-left text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors flex justify-between items-center">
                    <i class="fas fa-boxes w-6 text-center mr-2"></i>
                    <span>Packages</span>
                    <i class="fas fa-chevron-down transition-transform text-sm"></i>
                </button>
                <div class="dropdown-content pl-4 max-h-0 overflow-hidden transition-all duration-300">
                    <a href="{% url 'saritasapp:wardrobe_package_list' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Wardrobe Packages
                    </a>
                    <a href="{% url 'saritasapp:wedding_packages' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Wedding Packages
                    </a>
                    <a href="{% url 'saritasapp:debut_packages' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Debut Packages
                    </a>
                    <a href="{% url 'saritasapp:additional_services' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Additional Services
                    </a>
                </div>
            </div>

            <a href="{% url 'saritasapp:inventory_list' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-box w-6 text-center mr-2"></i>
                <span>Inventory</span>
            </a>
            <a href="{% url 'saritasapp:calendar' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-calendar w-6 text-center mr-2"></i>
                <span>Calendar of Event</span>
            </a>
            <a href="{% url 'saritasapp:rental_tracker' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-chart-line w-6 text-center mr-2"></i>
                <span>Rental Tracker</span>
            </a>
            
            <!-- Staff-only Approvals Dropdown (Desktop) -->
            {% if user.is_staff %}
            <div class="dropdown relative">
                <button class="w-full px-4 py-2 text-left text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors flex justify-between items-center">
                    <i class="fas fa-clipboard-check w-6 text-center mr-2"></i>
                    <span>Approvals</span>
                    <i class="fas fa-chevron-down transition-transform text-sm"></i>
                </button>
                <div class="dropdown-content pl-4 max-h-0 overflow-hidden transition-all duration-300">
                    <a href="{% url 'saritasapp:rental_approvals' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Item Rentals
                    </a>
                    <a href="{% url 'saritasapp:package_rental_approvals' %}" class="block px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                        Package Rentals
                    </a>
                </div>
            </div>
            {% else %}
            <a href="{% url 'saritasapp:rental_approvals' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-clipboard-check w-6 text-center mr-2"></i>
                <span>Rental Approvals</span>
            </a>
            {% endif %}
            
            <a href="{% url 'saritasapp:view_reservations' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-calendar-check w-6 text-center mr-2"></i>
                <span>View Reservations</span>
            </a>
            <a href="{% url 'saritasapp:receipt-detail' receipt_id=1 %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-receipt w-6 text-center mr-2"></i>
                <span>Receipt</span>
            </a>
            <a href="{% url 'saritasapp:data_analysis' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-chart-bar w-6 text-center mr-2"></i>
                <span>Data Analysis</span>
            </a>
            <a href="{% url 'saritasapp:customer_list' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-users w-6 text-center mr-2"></i>
                <span>Customer Records</span>
            </a>
            <a href="{% url 'saritasapp:manage_staff' %}" class="flex items-center px-4 py-2 text-gray-800 hover:bg-[#AD974F] rounded-lg transition-colors">
                <i class="fas fa-user-shield w-6 text-center mr-2"></i>
                <span>Manage Staff</span>
            </a>
        </div>
    </div>

    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 h-16 bg-[#EAEAEA] flex items-center justify-between px-4 z-50 border-b border-gray-800">
        <div class="flex items-center">
            <button id="mobile-toggle" class="lg:hidden text-2xl mr-2">
                ☰
            </button>
            <a href="{% url 'saritasapp:dashboard' %}" class="flex items-center gap-2">
                <img src="{% static 'images/Logo.png' %}" alt="Logo" class="w-12 h-12 rounded-full">
                <span class="text-2xl font-bold text-black" style="font-family: 'Great Vibes', cursive;">
                    Wedding Creations
                </span>
                <span class="text-xl font-semibold text-black" style="font-family: 'Playfair Display', serif;">
                    & Event Stylist
                </span>
            </a>
        </div>

        <!-- Desktop Header Items - Simplified -->
         
        <div class="hidden lg:flex items-center gap-6 mr-4">
            <a href="{% url 'customerapp:homepage' %}" 
            class="px-4 py-2 bg-[#AD974F] text-white rounded-lg hover:bg-[#8a7a3f] transition-colors">
             Go to Homepage
         </a>

            <a href="{% url 'saritasapp:staff_profile' %}" class="text-black hover:text-[#AD974F] transition-colors">
                <i class="fas fa-user text-xl"></i>
            </a>
            {% if user.is_authenticated %}
            <form method="post" action="{% url 'saritasapp:logout' %}">
                {% csrf_token %}
                <button type="submit" class="text-black font-semibold hover:text-[#AD974F] transition-colors">
                    Logout
                </button>
            </form>
            {% else %}
            <a href="{% url 'saritasapp:sign_in' %}" class="text-black font-semibold hover:text-[#AD974F] transition-colors">
                Login
            </a>
            {% endif %}
        </div>
    </header>

    <!-- Main Content -->
    <main class="pt-20 lg:pl-64 px-4 min-h-screen">
        {% block content %}
        {% endblock %}
    </main>

    <script>
        // Enhanced dropdown functionality
        document.querySelectorAll('.dropdown').forEach(dropdown => {
            const button = dropdown.querySelector('button');
            const content = dropdown.querySelector('.dropdown-content');
            const chevron = dropdown.querySelector('.fa-chevron-down');

            button.addEventListener('click', (e) => {
                e.stopPropagation();
                const isOpen = content.style.maxHeight !== '0px' && content.style.maxHeight !== '';
                
                // Close all other dropdowns
                document.querySelectorAll('.dropdown-content').forEach(otherContent => {
                    if(otherContent !== content) {
                        otherContent.style.maxHeight = '0';
                        otherContent.previousElementSibling.querySelector('.fa-chevron-down').classList.remove('rotate-180');
                    }
                });

                content.style.maxHeight = isOpen ? '0' : `${content.scrollHeight}px`;
                chevron.classList.toggle('rotate-180', !isOpen);
            });
        });

        document.addEventListener('click', (e) => {
            document.querySelectorAll('.dropdown').forEach(dropdown => {
                const content = dropdown.querySelector('.dropdown-content');
                const chevron = dropdown.querySelector('.fa-chevron-down');
                
                if(!dropdown.contains(e.target)) {
                    content.style.maxHeight = '0';
                    chevron.classList.remove('rotate-180');
                }
            });
        });

        const mobileSidebar = document.getElementById('mobile-sidebar');
        const mobileToggle = document.getElementById('mobile-toggle');

        mobileToggle.addEventListener('click', (e) => {
            e.stopPropagation();
            mobileSidebar.classList.toggle('-translate-x-full');
        });

        // Close sidebar when clicking outside
        document.addEventListener('click', (e) => {
            if (!mobileSidebar.contains(e.target) && !mobileToggle.contains(e.target)) {
                mobileSidebar.classList.add('-translate-x-full');
            }
        });
    </script>
</body>
</html>