
{% extends "saritasapp/base.html" %}
{% load static %}

{% block title %}Packages{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/Allpackages.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
{% endblock %}

{% block content %}



<button id="compareBtn" class="comparison-btn" disabled>
    <i class="fas fa-exchange-alt"></i> Compare Selected Packages (0)
</button>

<div class="packages-section">
    <h2 class="section-title">
        <i class="fas fa-heart"></i> Wedding Packages
    </h2>
    
    <div class="package-container">
        <!-- Wedding Package 1 -->
        <div class="package-box wedding" data-id="wedding-1">
            <div class="compare-checkbox">
                <input type="checkbox" id="compare-wedding-1" class="compare-check" data-id="wedding-1">
                <label for="compare-wedding-1">Compare</label>
            </div>
            
            <h2>Basic Wedding Package</h2>
            <div class="package-price">₱270,000 - ₱280,000</div>
            <div class="package-deposit">+ ₱10,000 refundable deposit</div>
            
            <div class="package-inclusions">
                <h3><i class="fas fa-hotel"></i> Hotel Venue / Food</h3>
                <ul>
                    <li>150 guests at ₱390 per head</li>
                    <li>Free overnight stay room accommodation</li>
                    <li>Free bridal car</li>
                    <li>Client's choice of menu</li>
                </ul>
                <div class="corkage-note">
                    <i class="fas fa-exclamation-circle"></i> All corkages will be charged to client
                </div>
                
                <h3><i class="fas fa-spa"></i> Floral Arrangement</h3>
                <ul>
                    <li>Church to venue (Christian wedding)</li>
                    <li>Bridal bouquet (fresh flower)</li>
                    <li>Groom's corsage</li>
                    <li>10 pairs principal sponsors corsage</li>
                    <li>3 pairs secondary sponsors corsage</li>
                    <li>1 maid of honor flower bouquet</li>
                    <li>1 bestman buttoner</li>
                    <li>4 bridesmaids flower bouquet</li>
                    <li>4 groomsmen buttoners</li>
                    <li>4 flowergirls headress and flower basket</li>
                    <li>Bridal car bouquet</li>
                    <li>Artificial flower stand aisle</li>
                </ul>
            </div>
            
            <button class="avail-btn">
                <i class="fas fa-envelope"></i> Inquire Now
            </button>
        </div>

        <!-- Wedding Package 2 - Marked as popular -->
        <div class="package-box wedding popular" data-id="wedding-2">
            <div class="compare-checkbox">
                <input type="checkbox" id="compare-wedding-2" class="compare-check" data-id="wedding-2">
                <label for="compare-wedding-2">Compare</label>
            </div>
            
            <h2>Premium Wedding Package</h2>
            <div class="package-price">₱300,000 - ₱310,000</div>
            <div class="package-deposit">+ ₱10,000 refundable deposit</div>
            
            <div class="package-inclusions">
                <h3><i class="fas fa-hotel"></i> Hotel Venue / Food</h3>
                <ul>
                    <li>Regency Hall (entire hall)</li>
                    <li>150 guests at ₱390 per head</li>
                    <li>Free room overnight stay only</li>
                    <li>Free bridal car</li>
                    <li>Client's choice of menu</li>
                </ul>
                <div class="corkage-note">
                    <i class="fas fa-exclamation-circle"></i> All corkages will be charged to client
                </div>
                
                <h3><i class="fas fa-spa"></i> Floral Arrangement</h3>
                <ul>
                    <li>Church to venue (Christian wedding)</li>
                    <li>Bridal bouquet (fresh flower)</li>
                    <li>Groom's corsage</li>
                    <li>10 pairs principal sponsors corsage</li>
                    <li>3 pairs secondary sponsors corsage</li>
                    <li>1 maid of honor flower bouquet</li>
                    <li>1 bestman buttoner</li>
                    <li>4 bridesmaids flower bouquet</li>
                    <li>4 groomsmen buttoners</li>
                    <li>4 flowergirls headress and flower basket</li>
                    <li>Bridal car bouquet</li>
                    <li>Artificial flower stand aisle</li>
                </ul>
                
                <h3><i class="fas fa-camera"></i> Photo & Video</h3>
                <ul>
                    <li>With same day edit</li>
                    <li>Prenup photoshoot</li>
                    <li>Postnuptial shots</li>
                    <li>2 set up cameras</li>
                    <li>Free USB full coverage video</li>
                    <li>Free wedding album</li>
                    <li>Same day edit video</li>
                </ul>
                <div class="corkage-note">
                    <i class="fas fa-exclamation-circle"></i> All corkages will be charged to client
                </div>
            </div>
            
            <button class="avail-btn">
                <i class="fas fa-envelope"></i> Inquire Now
            </button>
        </div>

        <!-- Wedding Package 3 -->
        <div class="package-box wedding" data-id="wedding-3">
            <div class="compare-checkbox">
                <input type="checkbox" id="compare-wedding-3" class="compare-check" data-id="wedding-3">
                <label for="compare-wedding-3">Compare</label>
            </div>
            
            <h2>Custom Wedding Package</h2>
            <div class="package-price">Custom Pricing</div>
            <div class="note">Contact us for a personalized quote based on your needs</div>
            
            <div class="package-inclusions">
                <h3><i class="fas fa-birthday-cake"></i> Wedding Cake</h3>
                <ul>
                    <li>2 tiered customized wedding cake</li>
                    <li>8 satellite cake</li>
                    <li>Client's choice of motif</li>
                </ul>
                
                <h3><i class="fas fa-envelope-open-text"></i> Wedding Invitation</h3>
                <ul>
                    <li>Customized lacer cut invitations (50pcs)</li>
                    <li>Client's choice of design and motif</li>
                </ul>
                
                <h3><i class="fas fa-users-cog"></i> Coordination Team</h3>
                <ul>
                    <li>Professional coordinator</li>
                    <li>Professional emcee</li>
                    <li>Assistant coordinators</li>
                    <li>Program flow</li>
                    <li>Table tags</li>
                    <li>Wedding acoustic singer</li>
                </ul>
                
                <h3><i class="fas fa-paint-brush"></i> Make Up Package</h3>
                <ul>
                    <li>Bride prenup photoshoot</li>
                    <li>Bride's on the day make up</li>
                    <li>10 heads on the day entourage make up</li>
                    <li>Included 2 mothers</li>
                </ul>
                
                <h3><i class="fas fa-lightbulb"></i> Lights & Sounds</h3>
                <ul>
                    <li>With LED wall</li>
                    <li>4 moving heads</li>
                    <li>Pallow spot</li>
                    <li>LED lights</li>
                    <li>Spot light</li>
                    <li>With smoke and bubbles machine</li>
                </ul>
                <div class="corkage-note">
                    <i class="fas fa-exclamation-circle"></i> All corkages will be charged to client
                </div>
            </div>
            
            <button class="avail-btn">
                <i class="fas fa-cogs"></i> Customize Your Package
            </button>
        </div>
    </div>
</div>





<!-- Comparison Modal -->
<div id="comparisonModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="document.getElementById('comparisonModal').style.display='none'">&times;</span>
        <h2>Package Comparison</h2>
        <div id="comparisonResults"></div>
    </div>
</div>

<div class="package-customization">
    <h2>Customize Your Wedding Package</h2>
    
    <form method="POST" action="{% url 'saritasapp:wedding_confirmation' %}">
        {% csrf_token %}
        
        <div class="customization-form">
            <!-- Gown/Tuxedo Sizes -->
            <div class="form-group">
                <label>Gown/Tuxedo Sizes:</label>
                <div class="size-controls">
                    <input type="number" name="bride_size" class="size-input" 
                           placeholder="Bride Size" min="0" max="50" step="0.5" required>
                    <input type="number" name="groom_size" class="size-input" 
                           placeholder="Groom Size" min="0" max="50" step="0.5" required>
                </div>
            </div>

            <!-- Number of Guests -->
            <div class="form-group">
                <label>Number of Guests:</label>
                <input type="number" id="guestCount" name="guests" 
                       min="50" max="500" value="150" onchange="calculateTotal()" required>
            </div>

            <!-- Venue Selection -->
            <div class="form-group">
                <label>Venue Selection:</label>
                <div class="venue-selection">
                    <select id="venueChoice" name="venue" class="form-control" required>
                        <option value="classic">Classic Ballroom</option>
                        <option value="garden">Garden Venue (+₱20,000)</option>
                        <option value="beach">Beachfront Venue (+₱35,000)</option>
                        <!-- Dynamically added custom venues will go here -->
                    </select>

                    <div class="custom-venue-input">
                        <input type="text" id="customVenueName" placeholder="Venue Name" class="form-control">
                        <input type="number" id="customVenuePrice" placeholder="Additional Cost" min="0" class="form-control">
                        <button type="button" class="btn-add-venue" onclick="addCustomVenue()">
                            <i class="fas fa-plus"></i> Add Custom Venue
                        </button>
                    </div>
                </div>
            </div>

            <!-- Additional Services -->
            <div class="add-services">
                <h4>Additional Services</h4>
                <div id="servicesContainer">
                    <div class="service-item">
                        <select name="services" class="service-select" onchange="calculateTotal()">
                            <option value="">Select Service</option>
                            <option value="videography">Professional Videography (+₱25,000)</option>
                            <option value="photo_album">Premium Photo Album (+₱8,000)</option>
                            <option value="fireworks">Fireworks Display (+₱15,000)</option>
                        </select>
                        <input type="number" class="service-qty" min="1" value="1" style="width: 60px;" onchange="calculateTotal()">
                    </div>
                </div>
                <button type="button" class="add-service-btn" onclick="addService()">
                    <i class="fas fa-plus-circle"></i> Add Another Service
                </button>
            </div>

            <!-- Total Price Summary -->
            <div class="price-summary">
                <h3>Total Price: ₱<span id="totalPrice">280,000</span></h3>
                <input type="hidden" name="total_price" id="totalPriceInput" value="280000">
            </div>

            <!-- Submit -->
            <div class="form-submit">
                <button type="submit" class="confirm-btn">
                    <i class="fas fa-check-circle"></i> Confirm Customization
                </button>
            </div>
        </div>
    </form>
</div>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Package Filtering
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                const filter = this.getAttribute('data-filter');
                document.querySelectorAll('.package-box').forEach(pkg => {
                    pkg.style.display = (filter === 'all' || pkg.classList.contains(filter)) ? 'block' : 'none';
                });
            });
        });

        // Comparison Modal Logic
        const compareCheckboxes = document.querySelectorAll('.compare-check');
        const compareBtn = document.getElementById('compareBtn');
        const comparisonModal = document.getElementById('comparisonModal');
        const closeModal = document.querySelector('.close');
        const comparisonResults = document.getElementById('comparisonResults');
        let selectedPackages = [];

        compareCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function () {
                const id = this.getAttribute('data-id');
                if (this.checked) {
                    selectedPackages.push(id);
                } else {
                    selectedPackages = selectedPackages.filter(i => i !== id);
                }
                updateCompareButton();
            });
        });

        function updateCompareButton() {
            compareBtn.disabled = selectedPackages.length < 2;
            compareBtn.innerHTML = `<i class="fas fa-exchange-alt"></i> Compare Selected Packages (${selectedPackages.length})`;
        }

        compareBtn.addEventListener('click', function () {
            if (selectedPackages.length < 2) return;

            const packages = Array.from(document.querySelectorAll('.package-box')).filter(pkg =>
                selectedPackages.includes(pkg.getAttribute('data-id'))
            );

            let tableHTML = `
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Feature</th>
                            ${packages.map(pkg => `<th>${pkg.querySelector('h2').textContent}</th>`).join('')}
                        </tr>
                        <tr>
                            <th>Price</th>
                            ${packages.map(pkg => `<td>${pkg.querySelector('.package-price').textContent}</td>`).join('')}
                        </tr>
                    </thead>
                    <tbody>
            `;

            const featuresSet = new Set();
            packages.forEach(pkg => {
                pkg.querySelectorAll('.package-inclusions li').forEach(li => {
                    featuresSet.add(li.textContent.trim());
                });
            });

            Array.from(featuresSet).forEach(feature => {
                tableHTML += `
                    <tr>
                        <td>${feature}</td>
                        ${packages.map(pkg => {
                            const features = Array.from(pkg.querySelectorAll('.package-inclusions li')).map(li => li.textContent.trim());
                            return `<td class="checkmark">${features.includes(feature) ? '✓' : ''}</td>`;
                        }).join('')}
                    </tr>
                `;
            });

            tableHTML += '</tbody></table>';
            comparisonResults.innerHTML = tableHTML;
            comparisonModal.style.display = 'block';
        });

        closeModal.addEventListener('click', () => comparisonModal.style.display = 'none');
        window.addEventListener('click', e => {
            if (e.target === comparisonModal) comparisonModal.style.display = 'none';
        });

        // Smooth Scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({ behavior: 'smooth' });
            });
        });

        // Pricing Logic
        const basePrice = 280000;
        const priceModifiers = {
            garden: 20000,
            beach: 35000,
            videography: 25000,
            photo_album: 8000,
            fireworks: 15000,
            custom_venues: {}
        };

        window.addCustomVenue = function () {
            const venueNameInput = document.getElementById('customVenueName');
            const venuePriceInput = document.getElementById('customVenuePrice');
            const venueName = venueNameInput.value.trim();
            const venuePrice = parseInt(venuePriceInput.value) || 0;

            if (venueName && venuePrice >= 0) {
                const venueId = `custom_${Date.now()}`;
                const option = document.createElement('option');
                option.value = venueId;
                option.textContent = `${venueName} (+₱${venuePrice.toLocaleString()})`;
                document.getElementById('venueChoice').appendChild(option);

                priceModifiers.custom_venues[venueId] = venuePrice;

                venueNameInput.value = '';
                venuePriceInput.value = '';
            }
        };

        window.calculateTotal = function () {
            let total = basePrice;

            const venueSelect = document.getElementById('venueChoice');
            const selectedVenue = venueSelect.value;
            if (selectedVenue.startsWith('custom_')) {
                total += priceModifiers.custom_venues[selectedVenue] || 0;
            } else {
                total += priceModifiers[selectedVenue] || 0;
            }

            document.querySelectorAll('.service-item').forEach(item => {
                const service = item.querySelector('.service-select').value;
                const qty = parseInt(item.querySelector('.service-qty').value) || 0;
                if (service) {
                    total += (priceModifiers[service] || 0) * qty;
                }
            });

            const guestCount = parseInt(document.getElementById('guestCount').value);
            if (guestCount > 150) {
                total += (guestCount - 150) * 390;
            }

            const totalPriceElem = document.getElementById('totalPrice');
            if (totalPriceElem) {
                totalPriceElem.textContent = total.toLocaleString('en-PH');
            }
        };

        window.addService = function () {
            const newService = document.createElement('div');
            newService.className = 'service-item';
            newService.innerHTML = `
                <select class="service-select" onchange="calculateTotal()">
                    <option value="">Select Service</option>
                    <option value="videography">Professional Videography (+₱25,000)</option>
                    <option value="photo_album">Premium Photo Album (+₱8,000)</option>
                    <option value="fireworks">Fireworks Display (+₱15,000)</option>
                </select>
                <input type="number" class="service-qty" min="1" value="1" style="width: 60px;" onchange="calculateTotal()">
            `;
            document.querySelector('.add-services').insertBefore(newService, document.querySelector('.add-service-btn'));
        };
    });
</script>

{% endblock %}