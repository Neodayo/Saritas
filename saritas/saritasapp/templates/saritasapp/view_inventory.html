{% extends "saritasapp/base.html" %}
{% load static %}

{% block title %}View Inventory{% endblock %}

{% block extra_css %}
<style>
    .inventory-container {
        max-width: 900px;
        margin: 40px auto;
        background-color: #fff;
        border-radius: 16px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        padding: 30px;
        text-align: center;
        font-family: 'Segoe UI', sans-serif;
    }

    .inventory-image {
        width: 300px;
        height: auto;
        max-height: 400px;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        cursor: pointer;
        margin-bottom: 20px;
        object-fit: cover;
    }

    .inventory-details h1 {
        font-size: 32px;
        margin-bottom: 10px;
        color: #231F20;
        font-weight: bold;
    }

    .inventory-details p {
        margin: 5px 0;
        font-size: 16px;
    }

    .inventory-details strong {
        color: #8E793E;
    }

    .btn {
        display: inline-block;
        padding: 10px 18px;
        margin: 10px 6px 0;
        font-size: 15px;
        text-decoration: none;
        border-radius: 8px;
        transition: background-color 0.3s ease;
    }

    .btn-primary {
        background-color: #8E793E;
        color: white;
    }

    .btn-primary:hover {
        background-color: #AD974F;
    }

    .btn-danger {
        background-color: #C0392B;
        color: white;
    }

    .btn-danger:hover {
        background-color: #E74C3C;
    }

    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        padding-top: 5%;
        padding-bottom: 5%;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        justify-content: center;
        align-items: center;
        background-color: rgba(0, 0, 0, 0.8);
    }

    .modal-content {
        display: block;
        max-width: 90%;
        max-height: 90%;
        margin: auto;
        border-radius: 16px;
    }

    .close {
        position: absolute;
        top: 20px;
        right: 35px;
        color: white;
        font-size: 40px;
        font-weight: bold;
        cursor: pointer;
    }

    .close:hover {
        color: #ccc;
    }

    .available-status {
        font-weight: bold;
        color: #2ecc71;
    }

    .btn-container {
        margin-top: 20px;
    }
</style>
{% endblock %}

{% block content %}
<div class="inventory-container">
    <!-- Image that opens modal -->
    <img src="{{ item.image.url }}" alt="{{ item.name }}" class="inventory-image"
         onclick="openModal()" onerror="this.src='https://via.placeholder.com/300';" />

    <!-- Item details -->
    <div class="inventory-details">
        <h1>{{ item.name }}</h1>
        <p><strong>Category:</strong> {{ item.category.name }}</p>
        <p><strong>Color:</strong> {{ item.color }}</p>
        <p><strong>Quantity:</strong> {{ item.quantity }}</p>
        <p><strong>Rental Price:</strong> ₱{{ item.rental_price }}</p>
        <p><strong>Purchase Price:</strong> 
            {% if item.purchase_price %}₱{{ item.purchase_price }}{% else %}N/A{% endif %}
        </p>
        <p><strong>Available:</strong> 
            {% if item.available %}
                <span class="available-status">✅ Yes</span>
            {% else %}
                <span style="color: red;">❌ No</span>
            {% endif %}
        </p>

        <!-- View full image button -->
        <a href="{{ item.image.url }}" target="_blank" class="btn btn-primary">View Full Image</a>

        <!-- Rent button -->
        {% if item.available and item.quantity > 0 %}
            <a href="{% url 'saritasapp:rental' item.id %}" class="btn btn-primary">Rent Item</a>
        {% endif %}
    </div>

    <!-- Action buttons -->
    <div class="btn-container">
        <a href="{% url 'saritasapp:inventory_list' %}" class="btn btn-primary">Back</a>
        <a href="{% url 'saritasapp:edit_inventory' item.id %}" class="btn btn-primary">Edit</a>
        <a href="{% url 'saritasapp:delete_inventory' item.id %}" class="btn btn-danger">Delete</a>
    </div>
</div>

<!-- Modal -->
<div id="imageModal" class="modal" onclick="closeModal()">
    <span class="close">&times;</span>
    <img class="modal-content" id="fullImage" alt="Full Image">
</div>

<!-- Modal Script -->
<script>
    function openModal() {
        const modal = document.getElementById('imageModal');
        const fullImage = document.getElementById('fullImage');
        fullImage.src = "{{ item.image.url|escapejs }}";
        modal.style.display = "block";
    }

    function closeModal() {
        document.getElementById('imageModal').style.display = "none";
    }
</script>
{% endblock %}
